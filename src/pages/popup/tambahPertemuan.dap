<div class="bg-white p-6 rounded-lg">
    <h1 class="text-3xl">Tambah Pertemuan Kelas</h1>
    <div x-data="{pertemuanForm : {}, quillEditor: null}" 
         x-init="
            // Initialize Quill editor when component loads
            $nextTick(() => {
                if (typeof Quill !== 'undefined') {
                    quillEditor = new Quill('#blog_text_editor', {
                        theme: 'snow',
                        modules: {
                            toolbar: [
                                [{ 'header': [1, 2, 3, false] }],
                                ['bold', 'italic', 'underline', 'strike'],
                                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                                ['link'],
                                ['clean']
                            ]
                        }
                    });
                    
                    // Update hidden input when editor content changes
                    quillEditor.on('text-change', function() {
                        const html = quillEditor.root.innerHTML;
                        const encodedHtml = encodeURIComponent(html);
                        document.getElementById('blog_text_hidden').value = encodedHtml;
                    });
                }
            });
         ">
        <input type="text" class="hidden" :value="id_kelas" x-init="pertemuanForm.id_kelas = id_kelas">
        <div class="mt-3">
            <label for="judul" class="block text-sm font-medium text-gray-700 mb-1">Judul Pertemuan</label>
            <input type="text" autocomplete="off" required x-model="pertemuanForm.judul" id="judul" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500">
        </div>
        <div class="mt-3">
            <label for="deskripsi" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi</label>
            <textarea required id="deskripsi" x-model="pertemuanForm.deskripsi" rows="5" class="w-full px-4 h-16 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500"></textarea>
        </div>
         <div class="mt-3">
            <label for="platform" class="block text-sm font-medium text-gray-700 mb-1">Platform</label>
            <select id="platform" required x-model="pertemuanForm.tipe_pertemuan"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500">
                <option value="" disabled selected hidden>-</option>
                <option value="Blog">Blog</option>
                <option value="YouTubeIframe">YouTube</option>
                <option value="External">Other (URL)</option>
            </select>
        </div>      
        <div class="mt-4" x-show="pertemuanForm.tipe_pertemuan == 'Blog'">
            <label for="blog_text" class="block text-sm font-medium text-gray-700 mb-1">Blog Text</label>
            <div id="blog_text_editor" class="border border-gray-300 rounded-lg" style="height: 200px;"></div>
            <input type="hidden" id="blog_text_hidden" x-model="pertemuanForm.blog_text">
        </div>
        <div class="mt-4" x-show="pertemuanForm.tipe_pertemuan === 'YouTubeIframe'">
            <label for="youtube_iframe_url" class="block text-sm font-medium text-gray-700 mb-1">YouTube Iframe URL</label>
            <input type="url" id="youtube_iframe_url" x-model="pertemuanForm.youtube_iframe_url" 
                placeholder="https://www.youtube.com/embed/xxxx" 
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500">
        </div>
    
        <div class="mt-4" x-show="pertemuanForm.tipe_pertemuan === 'External'">
            <label for="external_url" class="block text-sm font-medium text-gray-700 mb-1">External URL</label>
            <input type="url" id="external_url" x-model="pertemuanForm.external_url" 
                placeholder="https://example.com" 
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500">
        </div>   
        <div class="mt-12 flex flex-col gap-2">
            <button class="w-full bg-green-100 h-10 rounded-lg" @click="create_pertemuan_kelas(pertemuanForm)">Buat</button>
            <button class="w-full border-2 text-black border-gray-200 h-10 rounded-lg" @click="close_popup()">Batal</button>
        </div>
    </div>
</div>