<script src="https://cdn.tailwindcss.com"></script>
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/src/js/auth.js"></script>
<script src="/src/js/kelasPage.js"></script>
<script src="/src/js/global.js"></script>    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #4ade80;
        border-radius: 3px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #22c55e;
    }
    .video-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
    }
    .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
</style>
<div id="loading" class="flex" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: white; align-items: center; justify-content: center; z-index: 9999;"><div style="border: 4px solid #f3f3f3; border-top: 4px solid #2e8b57; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite;"></div><style>@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style></div>
<main x-data="{pertemuan : fetch_pertemuan_index(), list_pertemuan : {}}" class="mb-12">
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <h1 class="text-xl font-bold text-gray-800" x-text="(await pertemuan).data.kelas.judul"></h1>
            </div>
            <div class="flex items-center space-x-4">
                <button class="text-gray-600 hover:text-green-600">
                    <i class="fas fa-bell text-xl"></i>
                </button>
                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-user text-green-600"></i>
                </div>
            </div>
        </div>
    </header>
    <div class="container mx-auto px-4 py-6 mt-6 flex flex-col lg:flex-row">
        <!-- Left Content -->
        <main class="w-full lg:w-3/4 lg:pr-6">
            <div class="bg-white rounded-lg shadow-sm mb-6">
                <a class="text-2xl font-bold text-gray-800 mb-2" x-text="(await pertemuan).data.judul"></a>
                <div class="flex items-center text-sm text-gray-500 mb-4">
                    <span class="mr-3"><i class="fas fa-calendar-alt mr-1"></i> <span x-text="cetak_tenggal((await pertemuan).data.created_at)"></span></span>
                    <span><i class="fas fa-clock mr-1"></i> <span x-text="cetak_jam((await pertemuan).data.created_at)"></span></span>
                </div>
                
                <div id="YouTubeIframe" class="video-container hidden rounded-lg mb-6 overflow-hidden shadow">
                    <iframe 
                        src="https://www.youtube.com/embed/id" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                        allowfullscreen>
                    </iframe>
                </div>

                <div id="Blog" class="hidden rounded-lg overflow-hidden p-6 mb-6 shadow">
                    <p class="text-black" x-text="(await pertemuan).data.blog_text"></p>
                </div>
                
                <div id="External" class="hidden prose max-w-none mb-6">
                    <div class="w-full flex items-center justify-center" style="height: 250px;">
                        <div class="flex flex-col gap-6">
                            <button type="button" class="text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 focus:outline-none dark:focus:ring-green-800">
                                Join Kelas | <a :href="(await pertemuan).data.external_url">https://~</a>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="border-t text-black border-gray-200 pt-4" x-show="(await pertemuan).data.rangkuman">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Rangkuman</h3>
                    <div class="space-y-4">
                        <p x-text="(await pertemuan).data.rangkuman"></p>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Right Sidebar -->
        <aside class="w-full lg:w-1/4 sticky top-6 self-start">            
            <div class="bg-white rounded-lg shadow-sm p-4 mb-6" x-init="list_pertemuan = fetch_pertemuan((await pertemuan).data.id_kelas)">
                <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                    <i class="fas fa-list-ul text-green-500 mr-2"></i> Daftar Pertemuan
                </h3>
                <div class="space-y-2 max-h-96 overflow-y-auto custom-scrollbar">            
                    <template x-for="lp in (await list_pertemuan).data">
                        <a :href="'/p/'+lp.id_pertemuan_kelas" :id="lp.id_pertemuan_kelas"
                        class="block p-2 text-sm font-medium text-gray-800 rounded-lg hover:bg-green-100"
                        :class="lp.id_pertemuan_kelas == (await pertemuan).data.id_pertemuan_kelas ? 'bg-green-50' : ''">
                            <div class="flex items-center">
                                <i class="fas fa-play-circle text-green-500 mr-2"></i>
                                <span x-text="lp.judul"></span>
                            </div>
                        </a>
                    </template>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                    <i class="fas fa-chalkboard-user text-green-500 mr-2"></i> Mentor Kelas
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center space-x-3">
                        <img :src="(await pertemuan).data.kelas.pengguna.foto_url" alt="Mentor" class="w-10 h-10 bg-blue-800 rounded-full">
                        <div>
                            <p class="text-sm font-medium text-gray-900" x-text="(await pertemuan).data.kelas.pengguna.nama_lengkap"></p>
                            <p class="text-xs text-gray-500" x-text="(await pertemuan).data.kelas.id_mentor"></p>
                        </div>
                    </div>
                    <div class="mt-12">
                        <button class="w-full bg-gray-100 gap-2 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm flex items-center justify-center">
                            <i class="fa-brands fa-whatsapp"></i> Hubungi Mentor
                        </button>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                    <i class="fas fa-info-circle text-green-500 mr-2"></i> Informasi Kelas
                </h3>
                <div class="space-y-3">
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Judul Kelas</h4>
                        <p class="text-sm text-gray-800" x-text="(await pertemuan).data.kelas.judul"></p>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-500">Tanggal Dibuat</h4>
                        <p class="text-sm text-gray-800" x-text="cetak_tenggal((await pertemuan).data.created_at)"></p>
                    </div>
                </div>
            </div>

        </aside>
    </div>        
</main>
</body>
</html>