<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Kajian - Dynamic System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.3/cdn.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
    <link rel="stylesheet" href="../css/super-admin.css">

</head>
<body x-data="adminSystem()">
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            Admin Kajian
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" @click="currentPage = 'dashboard'" :class="{'active': currentPage === 'dashboard'}">Dashboard</a></li>
            <li><a href="#" @click="currentPage = 'manage-kelas-online'" :class="{'active': currentPage === 'manage-kelas-online'}">Manage Kelas Online</a></li>
            <li><a href="#" @click="currentPage = 'manage-kajian'" :class="{'active': currentPage === 'manage-kajian'}">Manage Kajian</a></li>
            <li><a href="#" @click="currentPage = 'manage-sedekah'" :class="{'active': currentPage === 'manage-sedekah'}">Manage Sedekah</a></li>
            <li><a href="#" @click="currentPage = 'manage-mentor'" :class="{'active': currentPage === 'manage-mentor'}">Manage Mentor</a></li>
            <li><a href="#" @click="currentPage = 'manage-customer'" :class="{'active': currentPage === 'manage-customer'}">Manage Customer</a></li>
        </ul>
        <div class="admin-info">
            <div class="admin-avatar"></div>
            <div class="admin-details">
                <p><strong>Admin</strong></p>
                <p>admin@gmail.com</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h1 x-text="getPageTitle()"></h1>
            <button class="logout-btn" @click="logout()">Logout</button>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Alert Messages -->
            <div x-show="alertMessage" x-transition class="alert" :class="alertType === 'success' ? 'alert-success' : 'alert-error'">
                <span x-text="alertMessage"></span>
            </div>

            <!-- Dashboard -->
            <div x-show="currentPage === 'dashboard'">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">ðŸ“š</div>
                        <div class="stat-info">
                            <h3 x-text="stats.kelas"></h3>
                            <p>Kelas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">ðŸ“–</div>
                        <div class="stat-info">
                            <h3 x-text="stats.kajian"></h3>
                            <p>Kajian</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon yellow">ðŸ’°</div>
                        <div class="stat-info">
                            <h3>Rp <span x-text="stats.donasi.toLocaleString()"></span></h3>
                            <p>Donasi</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon purple">ðŸ‘¥</div>
                        <div class="stat-info">
                            <h3 x-text="stats.pengguna.toLocaleString()"></h3>
                            <p>Pengguna</p>
                        </div>
                    </div>
                </div>

                <div class="data-table">
                    <div class="table-header">
                        <h3>Kegiatan Terbaru</h3>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Kegiatan</th>
                                <th>Tanggal</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="activity in recentActivities">
                                <tr>
                                    <td x-text="activity.name"></td>
                                    <td x-text="activity.date"></td>
                                    <td>
                                        <span class="status-badge" :class="activity.status === 'active' ? 'status-active' : 'status-ongoing'" x-text="activity.statusText"></span>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Kelas Online -->
            <div x-show="currentPage === 'manage-kelas-online'">
                <div class="data-table">
                    <div class="table-header">
                        <h3>Kelas Online</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" @click="openModal('add-kelas')">+ Tambah Kelas</button>
                            <button class="btn btn-primary" @click="loadKelasOnline()">Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nama Kelas</th>
                                <th>Mentor</th>
                                <th>Jadwal</th>
                                <th>Partisipasi</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody :class="{'loading': loading}">
                            <template x-for="kelas in kelasOnline">
                                <tr>
                                    <td x-text="kelas.nama_kelas"></td>
                                    <td x-text="kelas.mentor"></td>
                                    <td x-text="kelas.jadwal"></td>
                                    <td x-text="kelas.partisipasi"></td>
                                    <td>
                                        <span class="status-badge status-active" x-text="kelas.status"></span>
                                    </td>
                                    <td>
                                        <button class="btn btn-warning btn-sm" @click="editItem('kelas', kelas)">Edit</button>
                                        <button class="btn btn-danger btn-sm" @click="deleteItem('kelas', kelas.id)">Hapus</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Kajian -->
            <div x-show="currentPage === 'manage-kajian'">
                <div class="data-table">
                    <div class="table-header">
                        <h3>Kajian</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" @click="openModal('add-kajian')">+ Tambah Kajian</button>
                            <button class="btn btn-primary" @click="loadKajian()">Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Judul Kajian</th>
                                <th>Pengisi Acara</th>
                                <th>Tanggal & Waktu</th>
                                <th>Lokasi</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody :class="{'loading': loading}">
                            <template x-for="kajian in kajianList">
                                <tr>
                                    <td x-text="kajian.judul_kajian"></td>
                                    <td x-text="kajian.pengisi_acara"></td>
                                    <td x-text="kajian.tanggal_waktu"></td>
                                    <td x-text="kajian.lokasi"></td>
                                    <td>
                                        <button class="btn btn-warning btn-sm" @click="editItem('kajian', kajian)">Edit</button>
                                        <button class="btn btn-danger btn-sm" @click="deleteItem('kajian', kajian.id)">Hapus</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Sedekah -->
            <div x-show="currentPage === 'manage-sedekah'">
                <div class="data-table">
                    <div class="table-header">
                        <h3>Program Sedekah</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" @click="openModal('add-sedekah')">+ Tambah Sedekah</button>
                            <button class="btn btn-primary" @click="loadSedekah()">Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Program</th>
                                <th>Target</th>
                                <th>Terkumpul</th>
                                <th>Donatur</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody :class="{'loading': loading}">
                            <template x-for="sedekah in sedekahList">
                                <tr>
                                    <td x-text="sedekah.program"></td>
                                    <td>Rp <span x-text="sedekah.target.toLocaleString()"></span></td>
                                    <td>Rp <span x-text="sedekah.terkumpul.toLocaleString()"></span></td>
                                    <td x-text="sedekah.donatur"></td>
                                    <td>
                                        <span class="status-badge status-ongoing" x-text="sedekah.status"></span>
                                    </td>
                                    <td>
                                        <button class="btn btn-warning btn-sm" @click="editItem('sedekah', sedekah)">Edit</button>
                                        <button class="btn btn-danger btn-sm" @click="deleteItem('sedekah', sedekah.id)">Hapus</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Mentor -->
            <div x-show="currentPage === 'manage-mentor'">
                <div class="data-table">
                    <div class="table-header">
                        <h3>Mentor</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" @click="openModal('add-mentor')">+ Tambah Mentor</button>
                            <button class="btn btn-primary" @click="loadMentor()">Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Spesialis</th>
                                <th>Email</th>
                                <th>Nomor Telepon</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody :class="{'loading': loading}">
                            <template x-for="mentor in mentorList">
                                <tr>
                                    <td x-text="mentor.nama"></td>
                                    <td x-text="mentor.spesialis"></td>
                                    <td x-text="mentor.email"></td>
                                    <td x-text="mentor.nomor_telepon"></td>
                                    <td>
                                        <span class="status-badge status-active" x-text="mentor.status"></span>
                                    </td>
                                    <td>
                                        <button class="btn btn-warning btn-sm" @click="editItem('mentor', mentor)">Edit</button>
                                        <button class="btn btn-danger btn-sm" @click="deleteItem('mentor', mentor.id)">Hapus</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Manage Customer -->
            <div x-show="currentPage === 'manage-customer'">
                <div class="data-table">
                    <div class="table-header">
                        <h3>Customer</h3>
                        <div class="action-buttons">
                            <button class="btn btn-primary" @click="loadCustomer()">Refresh</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Email</th>
                                <th>Nomor Telepon</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody :class="{'loading': loading}">
                            <template x-for="customer in customerList">
                                <tr>
                                    <td x-text="customer.nama"></td>
                                    <td x-text="customer.email"></td>
                                    <td x-text="customer.nomor_telepon"></td>
                                    <td>
                                        <span class="status-badge status-active" x-text="customer.status"></span>
                                    </td>
                                    <td>
                                        <button class="btn btn-warning btn-sm" @click="editItem('customer', customer)">Edit</button>
                                        <button class="btn btn-danger btn-sm" @click="deleteItem('customer', customer.id)">Hapus</button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" :class="{'show': showModal}">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 x-text="modalTitle"></h3>
                <button @click="closeModal()" style="background: none; border: none; font-size: 20px; cursor: pointer;">&times;</button>
            </div>
            
            <form @submit.prevent="submitForm()">
                <div x-show="modalType.includes('kelas')">
                    <div class="form-group">
                        <label>Nama Kelas</label>
                        <input type="text" x-model="formData.nama_kelas" required>
                    </div>
                    <div class="form-group">
                        <label>Mentor</label>
                        <select x-model="formData.mentor" required>
                            <option value="">Pilih Mentor</option>
                            <template x-for="mentor in mentorList">
                                <option :value="mentor.nama" x-text="mentor.nama"></option>
                            </template>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Jadwal</label>
                        <input type="datetime-local" x-model="formData.jadwal" required>
                    </div>
                </div>

                <div x-show="modalType.includes('kajian')">
                    <div class="form-group">
                        <label>Judul Kajian</label>
                        <input type="text" x-model="formData.judul_kajian" required>
                    </div>
                    <div class="form-group">
                        <label>Pengisi Acara</label>
                        <select x-model="formData.pengisi_acara" required>
                            <option value="">Pilih Mentor</option>
                            <template x-for="mentor in mentorList">
                                <option :value="mentor.nama" x-text="mentor.nama"></option>
                            </template>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tanggal & Waktu</label>
                        <input type="datetime-local" x-model="formData.tanggal_waktu" required>
                    </div>
                    <div class="form-group">
                        <label>Lokasi</label>
                        <input type="text" x-model="formData.lokasi" required>
                    </div>
                </div>

                <div x-show="modalType.includes('sedekah')">
                    <div class="form-group">
                        <label>Program</label>
                        <input type="text" x-model="formData.program" required>
                    </div>
                    <div class="form-group">
                        <label>Target (Rp)</label>
                        <input type="number" x-model="formData.target" required>
                    </div>
                    <div class="form-group">
                        <label>Terkumpul (Rp)</label>
                        <input type="number" x-model="formData.terkumpul">
                    </div>
                </div>

                <div x-show="modalType.includes('mentor')">
                    <div class="form-group">
                        <label>Nama</label>
                        <input type="text" x-model="formData.nama" required>
                    </div>
                    <div class="form-group">
                        <label>Spesialis</label>
                        <input type="text" x-model="formData.spesialis" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" x-model="formData.email" required>
                    </div>
                    <div class="form-group">
                        <label>Nomor Telepon</label>
                        <input type="tel" x-model="formData.nomor_telepon" required>
                    </div>
                </div>

                <div x-show="modalType.includes('customer')">
                    <div class="form-group">
                        <label>Nama</label>
                        <input type="text" x-model="formData.nama" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" x-model="formData.email" required>
                    </div>
                    <div class="form-group">
                        <label>Nomor Telepon</label>
                        <input type="tel" x-model="formData.nomor_telepon" required>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; justify-content: end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" @click="closeModal()">Batal</button>
                    <button type="submit" class="btn btn-success" :disabled="loading">
                        <span x-show="!loading">Simpan</span>
                        <span x-show="loading">Loading...</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
    <script src="../js/super-admin.js"></script>
</html>